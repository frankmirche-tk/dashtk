parameters:
    app.openai.default_model: 'gpt-4o-mini'

services:
    _defaults:
        autowire: true
        autoconfigure: true

    App\:
        resource: '../src/'

    # Gemini (wie bisher)
    modelflow.gemini_client_factory:
        class: ModelflowAi\GoogleGeminiAdapter\ClientFactory
        factory: ['ModelflowAi\GoogleGeminiAdapter\ClientFactory', 'create']
        calls:
            - [withApiKey, ['%env(GOOGLE_API_KEY)%']]

    Gemini\Contracts\ClientContract:
        factory: ['@modelflow.gemini_client_factory', 'make']

    # ✅ OpenAI Client
    OpenAI\Client:
        factory: ['OpenAI', 'client']
        arguments:
            - '%env(string:OPENAI_API_KEY)%'

    # ✅ OpenAI Chat Service bekommt API Key injected (KEIN getenv)
    App\Service\OpenAiChatService:
        arguments:
            $apiKey: '%env(string:OPENAI_API_KEY)%'
            $defaultModel: '%app.openai.default_model%'

    App\Service\SupportChatService:
        arguments:
            $supportSolutionLogger: '@monolog.logger.support_solution'

    App\Service\ContactResolver:
        arguments:
            $projectDir: '%kernel.project_dir%'

    App\Controller\ContactResolverController:
        arguments:
            $contactLookupLogger: '@monolog.logger.contact_lookup'
